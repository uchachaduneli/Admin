<div fxLayout="row wrap">
  <mat-card style="width: 100%;">
    <mat-card-content>
      <form #excelImportForm="ngForm">
        <div fxLayout="row wrap" class="align-items-center">
          <div fxFlex="100" fxFlex.gt-md="80">
            <input matInput type="text" style="font-size: x-large"
                   value="არჩეულია კომპანია: {{foundedSenderContact.name}} - #{{foundedSenderContact.identNumber}}"
                   name="foundedDataOutput" [readonly]="true"
                   *ngIf="foundedSenderContact && foundedSenderContact.id > 0"
                   class="search-input">
          </div>
          <div fxFlex="100" fxFlex.gt-md="10" align="end">
            <a style="float: right; height: 70px;" title="Export To Excel" href="./assets/parcelTemplate.xlsx"
               class="m-r-10 cursor-pointer">
              <img style="height: 30px;" src="./assets/images/excel.png">&nbsp;&nbsp;
              <span style="margin-top: 0.2%; position: absolute;">შაბლონი</span>
            </a>
          </div>
        </div>
        <br><br>
        <div fxLayout="row wrap" class="align-items-center">
          <div fxFlex="100" fxFlex.gt-md="50">
            <mat-form-field>
              <input matInput type="number" [(ngModel)]="identNumber"
                     name="senderIdentNumber" (keyup.enter)="searchContact()"
                     placeholder=" საიდენტიფიკაციო #" class="search-input">
            </mat-form-field>
          </div>
          <div fxFlex="100" fxFlex.gt-md="10" fxLayoutGap="5px" style="margin: auto;">
            <button mat-button bg-success mat-flat-button color="warn" (click)="searchContact()"
                    [disabled]="!excelImportForm.valid"> ძებნა
              <mat-icon>search</mat-icon>
            </button>
          </div>
          <div fxFlex="100" fxFlex.gt-md="38" style="margin: auto;">
            <button mat-button (click)="clear()">გასუფთავება
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
        <mat-form-field>
          <mat-select name="sticker" [(ngModel)]="stickerId" placeholder="სტიკერი"
                      aria-placeholder="სტიკერი">
            <mat-option *ngFor="let c of stikersList" [value]="c.id">{{c.name}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field>
          <mat-select [(ngModel)]="routeId" name="route"
                      placeholder="მარშრუტი" aria-placeholder="მარშრუტი">
            <mat-option *ngFor="let c of routes" [value]="c.id">{{c.name}}</mat-option>
          </mat-select>
        </mat-form-field>
        <div *ngIf="foundedSenderContact && foundedSenderContact.id > 0 && routeId > 0 && stickerId > 0">
          <div fxLayout="row wrap" class="align-items-center">
            <input type="file" style="display: none;"
                   (change)="selectFile($event)" #fileUpload>
            <div class="file-upload">
              <button mat-mini-fab color="primary" class="upload-btn"
                      (click)="fileUpload.click()">
                <mat-icon>attach_file</mat-icon>
              </button> &nbsp;
              <a (click)="fileUpload.click()">ატვირთვა</a>
            </div>
          </div>

          <div *ngIf="currentFile" class="progress my-3">
            <div class="progress-bar progress-bar-info progress-bar-striped"
                 role="progressbar" attr.aria-valuenow="{{ progress }}"
                 aria-valuemin="0" aria-valuemax="100" [ngStyle]="{ width: progress + '%' }">
              ატვირთულია {{ progress }}% - მიმდინარეობს დამუშავება
            </div>
          </div>
        </div>
      </form>
      <button mat-button bg-primary mat-flat-button color="warn" (click)="moveToMainTable()"
              [disabled]="resultsLength === 0"> ძირითადში გადატანა
        <mat-icon>playlist_add_check</mat-icon>
      </button>
      <br>
      <mat-header-row></mat-header-row>
      <div class="example-loading-shade" *ngIf="isLoadingResults">
        <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
      </div>
      <div class="example-container m-t-20">
        <div class="example-table-container responsive-table">
          <table mat-table [dataSource]="data" class="example-table striped">

            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef> #</th>
              <td mat-cell *matCellDef="let element"> {{element.id}} </td>
            </ng-container>

            <ng-container matColumnDef="barCode">
              <th mat-header-cell *matHeaderCellDef> ბარკოდი</th>
              <td mat-cell *matCellDef="let element"> {{element.barCode}} </td>
            </ng-container>

            <ng-container matColumnDef="sender">
              <th mat-header-cell *matHeaderCellDef>გამგზავნი</th>
              <td mat-cell *matCellDef="let element"> {{element.sender.name}} - #{{element.sender.identNumber}}</td>
            </ng-container>

            <ng-container matColumnDef="receiverName">
              <th mat-header-cell *matHeaderCellDef>მიმღები</th>
              <td mat-cell *matCellDef="let element"> {{element.receiverName}} - #{{element.receiverIdentNumber}}</td>
            </ng-container>

            <ng-container matColumnDef="receiverContactPerson">
              <th mat-header-cell *matHeaderCellDef>საკონტაქტო პირი</th>
              <td mat-cell *matCellDef="let element"> {{element.receiverContactPerson}} ({{element.receiverPhone}})</td>
            </ng-container>

            <ng-container matColumnDef="weight">
              <th mat-header-cell *matHeaderCellDef>წონა</th>
              <td mat-cell *matCellDef="let element"> {{element.weight}}</td>
            </ng-container>

            <ng-container matColumnDef="totalPrice">
              <th mat-header-cell *matHeaderCellDef>ფასი</th>
              <td mat-cell *matCellDef="let element"> {{element.totalPrice}}</td>
            </ng-container>

            <ng-container matColumnDef="createdTime">
              <th mat-header-cell *matHeaderCellDef> შეიქმნა</th>
              <td mat-cell *matCellDef="let element"> {{element.createdTime | date :'short'}} </td>
            </ng-container>

            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef> მოქმედება</th>
              <td mat-cell *matCellDef="let element" class="action-link">
                <a (click)="openDialog('Details',element)" class="m-r-10 cursor-pointer">
                  <mat-icon>content_paste</mat-icon>
                </a>
                <a (click)="openDialog('Delete',element)" class="m-r-10 cursor-pointer">
                  <mat-icon>delete_outline</mat-icon>
                </a>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openDialog('Details', row)"></tr>
          </table>
        </div>
        <mat-paginator showFirstLastButtons [length]="resultsLength" [pageSize]="10"
                       [pageSizeOptions]="[5, 10, 50]"></mat-paginator>
      </div>

    </mat-card-content>
  </mat-card>
</div>
